{"ast":null,"code":"import _classCallCheck from \"C:\\\\projetos\\\\seed-dotnet6.0angular13\\\\Seed.Spa.Ui\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"C:\\\\projetos\\\\seed-dotnet6.0angular13\\\\Seed.Spa.Ui\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport _inherits from \"C:\\\\projetos\\\\seed-dotnet6.0angular13\\\\Seed.Spa.Ui\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\inherits.js\";\nimport _createSuper from \"C:\\\\projetos\\\\seed-dotnet6.0angular13\\\\Seed.Spa.Ui\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createSuper.js\";\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) {\n    if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  }\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __metadata = this && this.__metadata || function (k, v) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\n\nimport { Component, ViewChild, ChangeDetectorRef, Input } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { ModalDirective } from 'ngx-bootstrap/modal';\nimport { SampleService } from './sample.service';\nimport { GlobalService, NotificationParameters } from '../../global.service';\nimport { ComponentBase } from '../../common/components/component.base';\n\nvar SampleComponent = /*#__PURE__*/function (_ComponentBase) {\n  _inherits(SampleComponent, _ComponentBase);\n\n  var _super = _createSuper(SampleComponent);\n\n  function SampleComponent(sampleService, router, ref) {\n    var _this;\n\n    _classCallCheck(this, SampleComponent);\n\n    _this = _super.call(this);\n    _this.sampleService = sampleService;\n    _this.router = router;\n    _this.ref = ref;\n    _this.vm = null;\n    return _this;\n  }\n\n  _createClass(SampleComponent, [{\n    key: \"ngOnInit\",\n    value: function ngOnInit() {\n      var _this2 = this;\n\n      this.vm = this.sampleService.initVM();\n      this.configurationForParent();\n      if (this.parentIdValue) this.vm.modelFilter[this.parentIdField] = this.parentIdValue;\n      this.onFilter(this.vm.modelFilter);\n      this.updateCulture();\n      this.changeCultureEmitter = GlobalService.getChangeCultureEmitter().subscribe(function (culture) {\n        _this2.updateCulture(culture);\n      });\n      this.vm.isParent = this.isParent;\n      this.vm.ParentIdField = this.parentIdField;\n    }\n  }, {\n    key: \"configurationForParent\",\n    value: function configurationForParent() {\n      if (this.isParent) {\n        this._showBtnBack = false;\n        this._showBtnFilter = false;\n        this._showBtnDetails = false;\n        this._showBtnPrint = false;\n      }\n    }\n  }, {\n    key: \"updateCulture\",\n    value: function updateCulture() {\n      var _this3 = this;\n\n      var culture = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n      this.sampleService.updateCulture(culture).then(function (infos) {\n        _this3.vm.infos = infos;\n        _this3.vm.grid = _this3.sampleService.getInfoGrid(infos);\n      });\n      this.sampleService.updateCultureMain(culture).then(function (infos) {\n        _this3.vm.generalInfo = infos;\n      });\n    }\n  }, {\n    key: \"onFilter\",\n    value: function onFilter(modelFilter) {\n      var _this4 = this;\n\n      modelFilter.queryOptimizerBehavior = \"GRID_Sample\".toUpperCase();\n      this.sampleService.get(modelFilter).subscribe(function (result) {\n        _this4.vm.filterResult = result.dataList;\n        _this4.vm.summary = result.summary;\n\n        _this4.filterModal.hide();\n      });\n    }\n  }, {\n    key: \"onExport\",\n    value: function onExport() {\n      this.sampleService.export(Object.assign(this.vm.modelFilter, {\n        AttributeBehavior: \"exportar\"\n      })).subscribe(function (result) {\n        var a = document.createElement(\"a\");\n        document.body.appendChild(a);\n        a.style.visibility = 'hidden';\n        var blob = new Blob([result._body], {\n          type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n        }); //Ou\n        //var blob = new Blob([result], {\n        //  type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n        //});\n\n        var downloadUrl = window.URL.createObjectURL(blob);\n        a.href = downloadUrl;\n        a.download = \"Sample.xlsx\";\n        a.click();\n        window.URL.revokeObjectURL(downloadUrl);\n      });\n    }\n  }, {\n    key: \"onCreate\",\n    value: function onCreate() {\n      this.showContainerCreate();\n      this.vm.model = {};\n      if (this.parentIdValue) this.vm.model[this.parentIdField] = this.parentIdValue;\n      this.navigateStrategy(this.vm, this.saveModal, this.router, \"/sample/create\");\n    }\n  }, {\n    key: \"onEdit\",\n    value: function onEdit(model) {\n      var _this5 = this;\n\n      this.vm.model = {};\n      var newModel = model;\n\n      if (model) {\n        newModel = {\n          id: model.sampleId\n        };\n      }\n\n      if (!this.vm.navigationModal) {\n        this.navigateStrategy(this.vm, this.editModal, this.router, \"/sample/edit/\" + newModel.id);\n      } else {\n        this.sampleService.get(newModel).subscribe(function (result) {\n          _this5.vm.model = result.dataList ? result.dataList[0] : result.data;\n\n          _this5.showContainerEdit();\n\n          _this5.editModal.show();\n        });\n      }\n    }\n  }, {\n    key: \"onSave\",\n    value: function onSave(model) {\n      var _this6 = this;\n\n      this.sampleService.save(model).subscribe(function (result) {\n        _this6.onFilter(_this6.vm.modelFilter);\n\n        if (!_this6.vm.manterTelaAberta) {\n          _this6.saveModal.hide();\n\n          _this6.editModal.hide();\n\n          _this6.hideContainerCreate();\n\n          _this6.hideContainerEdit();\n        }\n      });\n    }\n  }, {\n    key: \"onDetails\",\n    value: function onDetails(model) {\n      var _this7 = this;\n\n      this.vm.details = {};\n      var newModel = model;\n\n      if (model) {\n        newModel = {\n          id: model.sampleId\n        };\n      }\n\n      if (!this.vm.navigationModal) {\n        this.navigateStrategy(this.vm, this.editModal, this.router, \"/sample/details/\" + newModel.id);\n      } else {\n        this.sampleService.get(newModel).subscribe(function (result) {\n          _this7.vm.details = result.dataList ? result.dataList[0] : result.data;\n\n          _this7.showContainerDetails();\n\n          _this7.detailsModal.show();\n        });\n      }\n    }\n  }, {\n    key: \"onCancel\",\n    value: function onCancel() {\n      this.saveModal.hide();\n      this.editModal.hide();\n      this.detailsModal.hide();\n      this.filterModal.hide();\n      this.hideComponents();\n    }\n  }, {\n    key: \"onShowFilter\",\n    value: function onShowFilter() {\n      this.showContainerFilters();\n      this.filterModal.show();\n    }\n  }, {\n    key: \"onClearFilter\",\n    value: function onClearFilter() {\n      this.vm.modelFilter = {};\n      GlobalService.getNotificationEmitter().emit(new NotificationParameters(\"init\", {\n        model: {}\n      }));\n    }\n  }, {\n    key: \"onPrint\",\n    value: function onPrint(model) {\n      this.router.navigate(['/sample/print', model.sampleId]);\n    }\n  }, {\n    key: \"onDeleteConfimation\",\n    value: function onDeleteConfimation(model) {\n      var _this8 = this;\n\n      var conf = GlobalService.operationExecutedParameters(\"confirm-modal\", function () {\n        var newModel = model;\n\n        if (model) {\n          newModel = {\n            id: model.sampleId\n          };\n        }\n\n        _this8.sampleService.delete(newModel).subscribe(function (result) {\n          _this8.vm.filterResult = _this8.vm.filterResult.filter(function (model) {\n            return model.sampleId != result.data.sampleId;\n          });\n          _this8.vm.summary.total = _this8.vm.filterResult.length;\n        });\n      });\n      GlobalService.getOperationExecutedEmitter().emit(conf);\n    }\n  }, {\n    key: \"onConfimationYes\",\n    value: function onConfimationYes() {\n      this.operationConfimationYes();\n    }\n  }, {\n    key: \"onPageChanged\",\n    value: function onPageChanged(pageConfig) {\n      var _this9 = this;\n\n      var modelFilter = this.sampleService.pagingConfig(this.vm.modelFilter, pageConfig);\n      this.sampleService.get(modelFilter).subscribe(function (result) {\n        _this9.vm.filterResult = result.dataList;\n        _this9.vm.summary = result.summary;\n      });\n    }\n  }, {\n    key: \"onOrderBy\",\n    value: function onOrderBy(order) {\n      var _this10 = this;\n\n      var modelFilter = this.sampleService.orderByConfig(this.vm.modelFilter, order);\n      this.sampleService.get(modelFilter).subscribe(function (result) {\n        _this10.vm.filterResult = result.dataList;\n        _this10.vm.summary = result.summary;\n      });\n    }\n  }, {\n    key: \"ngOnDestroy\",\n    value: function ngOnDestroy() {\n      if (this.changeCultureEmitter) this.changeCultureEmitter.unsubscribe();\n      this.sampleService.detectChangesStop();\n    }\n  }]);\n\n  return SampleComponent;\n}(ComponentBase);\n\n__decorate([Input(), __metadata(\"design:type\", Object)], SampleComponent.prototype, \"parentIdValue\", void 0);\n\n__decorate([Input(), __metadata(\"design:type\", String)], SampleComponent.prototype, \"parentIdField\", void 0);\n\n__decorate([Input(), __metadata(\"design:type\", Boolean)], SampleComponent.prototype, \"isParent\", void 0);\n\n__decorate([ViewChild('filterModal', {\n  static: false\n}), __metadata(\"design:type\", ModalDirective)], SampleComponent.prototype, \"filterModal\", void 0);\n\n__decorate([ViewChild('saveModal', {\n  static: false\n}), __metadata(\"design:type\", ModalDirective)], SampleComponent.prototype, \"saveModal\", void 0);\n\n__decorate([ViewChild('editModal', {\n  static: false\n}), __metadata(\"design:type\", ModalDirective)], SampleComponent.prototype, \"editModal\", void 0);\n\n__decorate([ViewChild('detailsModal', {\n  static: false\n}), __metadata(\"design:type\", ModalDirective)], SampleComponent.prototype, \"detailsModal\", void 0);\n\nSampleComponent = __decorate([Component({\n  selector: 'app-sample',\n  templateUrl: './sample.component.html',\n  styleUrls: ['./sample.component.css'],\n  host: {\n    '[class.className]': '_showClassName',\n    '[class]': '_classNames'\n  }\n}), __metadata(\"design:paramtypes\", [SampleService, Router, ChangeDetectorRef])], SampleComponent);\nexport { SampleComponent };","map":null,"metadata":{},"sourceType":"module"}