{"ast":null,"code":"import _classCallCheck from \"C:\\\\projetos\\\\seed-dotnet6.0angular13\\\\Seed.Spa.Ui\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"C:\\\\projetos\\\\seed-dotnet6.0angular13\\\\Seed.Spa.Ui\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport { EventEmitter } from '@angular/core';\nimport { ViewModel } from '../model/viewmodel';\nimport { ServiceBase } from '../services/service.base';\nimport { ApiService } from '../services/api.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/service.base\";\nimport * as i2 from \"../services/api.service\";\n\nfunction MakeGridOrderComponent_make_grid_0_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"make-grid\", 6);\n    i0.ɵɵlistener(\"edit\", function MakeGridOrderComponent_make_grid_0_Template_make_grid_edit_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      var ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.onEdit($event);\n    })(\"details\", function MakeGridOrderComponent_make_grid_0_Template_make_grid_details_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      var ctx_r5 = i0.ɵɵnextContext();\n      return ctx_r5.onDetails($event);\n    })(\"print\", function MakeGridOrderComponent_make_grid_0_Template_make_grid_print_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      var ctx_r6 = i0.ɵɵnextContext();\n      return ctx_r6.onPrint($event);\n    })(\"deleteConfimation\", function MakeGridOrderComponent_make_grid_0_Template_make_grid_deleteConfimation_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      var ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.onDeleteConfimation($event);\n    })(\"orderBy\", function MakeGridOrderComponent_make_grid_0_Template_make_grid_orderBy_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      var ctx_r8 = i0.ɵɵnextContext();\n      return ctx_r8.onOrderBy($event);\n    })(\"filter\", function MakeGridOrderComponent_make_grid_0_Template_make_grid_filter_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      var ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.onFilter($event);\n    })(\"vmChange\", function MakeGridOrderComponent_make_grid_0_Template_make_grid_vmChange_0_listener($event) {\n      i0.ɵɵrestoreView(_r4);\n      var ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.vm = $event;\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"vm\", ctx_r0.vm)(\"showFilters\", ctx_r0.showFilters)(\"showPrint\", ctx_r0.showPrint)(\"showDelete\", ctx_r0.showDelete)(\"showDetails\", ctx_r0.showDetails)(\"showEdit\", ctx_r0.showEdit);\n  }\n}\n\nfunction MakeGridOrderComponent_nestable_tree_1_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r12 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"nestable-tree\", 7);\n    i0.ɵɵlistener(\"change\", function MakeGridOrderComponent_nestable_tree_1_Template_nestable_tree_change_0_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      var ctx_r11 = i0.ɵɵnextContext();\n      return ctx_r11.onChangeNestable($event);\n    });\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"data\", ctx_r1.nestableData)(\"id\", ctx_r1.content - ctx_r1.nestable);\n  }\n}\n\nfunction MakeGridOrderComponent_button_3_Template(rf, ctx) {\n  if (rf & 1) {\n    var _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 8);\n    i0.ɵɵlistener(\"click\", function MakeGridOrderComponent_button_3_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r14);\n      var ctx_r13 = i0.ɵɵnextContext();\n      return ctx_r13.onSaveOrder();\n    });\n    i0.ɵɵelement(1, \"i\", 9);\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport var MakeGridOrderComponent = /*#__PURE__*/(function () {\n  var MakeGridOrderComponent = /*#__PURE__*/function () {\n    function MakeGridOrderComponent(servicebase, api) {\n      _classCallCheck(this, MakeGridOrderComponent);\n\n      this.servicebase = servicebase;\n      this.api = api;\n      this.customButton = [];\n      this.edit = new EventEmitter();\n      this.details = new EventEmitter();\n      this.print = new EventEmitter();\n      this.deleteConfimation = new EventEmitter();\n      this.orderBy = new EventEmitter();\n      this.filter = new EventEmitter();\n      this.change = new EventEmitter();\n      this.viewgrid = true;\n      this.savePending = false;\n    }\n\n    _createClass(MakeGridOrderComponent, [{\n      key: \"onChangeView\",\n      value: function onChangeView() {\n        this.viewgrid = !this.viewgrid;\n        this.loadNestableData();\n      }\n    }, {\n      key: \"setdefaultprops\",\n      value: function setdefaultprops() {\n        if (!this.resourceOrder) this.resourceOrder = this.vm.key;\n        if (!this.fieldNameDisplay) this.fieldNameDisplay = \"name\";\n        if (!this.fieldNameId) this.fieldNameId = this.servicebase.objectToArrayWithKeys(this.vm.infos).filter(function (item) {\n          return item.infos.isKey;\n        })[0].key;\n        if (!this.fieldNameOrder) this.fieldNameOrder = \"order\";\n      }\n    }, {\n      key: \"loadNestableData\",\n      value: function loadNestableData() {\n        var _this = this;\n\n        this.setdefaultprops();\n        this.nestableData = this.vm.filterResult.map(function (item) {\n          return {\n            id: item[_this.fieldNameId],\n            name: item[_this.fieldNameDisplay],\n            dataAditional: item\n          };\n        });\n      }\n    }, {\n      key: \"ngOnChanges\",\n      value: function ngOnChanges() {\n        this.loadNestableData();\n      }\n    }, {\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        this.loadNestableData();\n      }\n    }, {\n      key: \"onEdit\",\n      value: function onEdit(model) {\n        this.edit.emit(model);\n      }\n    }, {\n      key: \"onDetails\",\n      value: function onDetails(model) {\n        this.details.emit(model);\n      }\n    }, {\n      key: \"onPrint\",\n      value: function onPrint(model) {\n        this.print.emit(model);\n      }\n    }, {\n      key: \"onDeleteConfimation\",\n      value: function onDeleteConfimation(model) {\n        this.deleteConfimation.emit(model);\n      }\n    }, {\n      key: \"onOrderBy\",\n      value: function onOrderBy(model) {\n        this.orderBy.emit(model);\n      }\n    }, {\n      key: \"onFilter\",\n      value: function onFilter(modelFilter) {\n        this.filter.emit(modelFilter);\n      }\n    }, {\n      key: \"onChangeNestable\",\n      value: function onChangeNestable(e) {\n        this.change.emit(e);\n        this.savePending = true;\n        this.itensPending = e;\n      }\n    }, {\n      key: \"onSaveOrder\",\n      value: function onSaveOrder(e) {\n        var _this2 = this;\n\n        var orderned = this.itensPending.map(function (item, i) {\n          var model = item.aditional;\n          model[_this2.fieldNameOrder] = i + 1;\n          model[\"attributeBehavior\"] = \"SaveOrder\";\n          return model;\n        });\n        console.log(\"onSaveOrder\", orderned);\n        this.api.setResource(this.resourceOrder).postMany(orderned).subscribe(function (response) {\n          _this2.filter.emit(_this2.vm.modelFilter);\n\n          _this2.savePending = false;\n\n          _this2.onChangeView();\n        });\n      }\n    }]);\n\n    return MakeGridOrderComponent;\n  }();\n\n  MakeGridOrderComponent.ɵfac = function MakeGridOrderComponent_Factory(t) {\n    return new (t || MakeGridOrderComponent)(i0.ɵɵdirectiveInject(i1.ServiceBase), i0.ɵɵdirectiveInject(i2.ApiService));\n  };\n\n  MakeGridOrderComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MakeGridOrderComponent,\n    selectors: [[\"make-grid-order\"]],\n    inputs: {\n      vm: \"vm\",\n      showCustom: \"showCustom\",\n      showFilters: \"showFilters\",\n      showEdit: \"showEdit\",\n      showDetails: \"showDetails\",\n      showPrint: \"showPrint\",\n      showDelete: \"showDelete\",\n      showOrderBy: \"showOrderBy\",\n      showCheckbox: \"showCheckbox\",\n      showAction: \"showAction\",\n      actionLeft: \"actionLeft\",\n      gridCss: \"gridCss\",\n      customButton: \"customButton\",\n      checkboxProperty: \"checkboxProperty\",\n      fieldNameDisplay: \"fieldNameDisplay\",\n      fieldNameId: \"fieldNameId\",\n      fieldNameOrder: \"fieldNameOrder\",\n      resourceOrder: \"resourceOrder\"\n    },\n    outputs: {\n      edit: \"edit\",\n      details: \"details\",\n      print: \"print\",\n      deleteConfimation: \"deleteConfimation\",\n      orderBy: \"orderBy\",\n      filter: \"filter\",\n      change: \"change\"\n    },\n    features: [i0.ɵɵNgOnChangesFeature],\n    decls: 6,\n    vars: 3,\n    consts: [[3, \"vm\", \"showFilters\", \"showPrint\", \"showDelete\", \"showDetails\", \"showEdit\", \"edit\", \"details\", \"print\", \"deleteConfimation\", \"orderBy\", \"filter\", \"vmChange\", 4, \"ngIf\"], [3, \"data\", \"id\", \"change\", 4, \"ngIf\"], [1, \"col\", \"text-right\", \"mt-3\"], [\"class\", \"btn btn-success\", \"title\", \"Salvar Orderna\\xE7\\xE3o\", 3, \"click\", 4, \"ngIf\"], [\"title\", \"Trocar Vis\\xE3o\", 1, \"btn\", \"btn-warning\", 3, \"click\"], [1, \"fa\", \"fa-tasks\"], [3, \"vm\", \"showFilters\", \"showPrint\", \"showDelete\", \"showDetails\", \"showEdit\", \"edit\", \"details\", \"print\", \"deleteConfimation\", \"orderBy\", \"filter\", \"vmChange\"], [3, \"data\", \"id\", \"change\"], [\"title\", \"Salvar Orderna\\xE7\\xE3o\", 1, \"btn\", \"btn-success\", 3, \"click\"], [1, \"fa\", \"fa-check\"]],\n    template: function MakeGridOrderComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, MakeGridOrderComponent_make_grid_0_Template, 1, 6, \"make-grid\", 0);\n        i0.ɵɵtemplate(1, MakeGridOrderComponent_nestable_tree_1_Template, 1, 2, \"nestable-tree\", 1);\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵtemplate(3, MakeGridOrderComponent_button_3_Template, 2, 0, \"button\", 3);\n        i0.ɵɵelementStart(4, \"button\", 4);\n        i0.ɵɵlistener(\"click\", function MakeGridOrderComponent_Template_button_click_4_listener() {\n          return ctx.onChangeView();\n        });\n        i0.ɵɵelement(5, \"i\", 5);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.viewgrid);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.viewgrid && ctx.nestableData && ctx.vm.filterResult);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngIf\", ctx.savePending);\n      }\n    },\n    encapsulation: 2\n  });\n  return MakeGridOrderComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}