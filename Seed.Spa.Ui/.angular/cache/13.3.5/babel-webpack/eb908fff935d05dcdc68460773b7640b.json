{"ast":null,"code":"import _classCallCheck from \"C:\\\\projetos\\\\seed-dotnet6.0angular13\\\\Seed.Spa.Ui\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";\nimport _createClass from \"C:\\\\projetos\\\\seed-dotnet6.0angular13\\\\Seed.Spa.Ui\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";\nimport { SimpleChanges, SecurityContext } from '@angular/core';\nimport { DatePipe, DecimalPipe, PercentPipe, CurrencyPipe } from \"@angular/common\";\nimport { DomSanitizer } from '@angular/platform-browser';\nimport { ApiService } from \"../../common/services/api.service\";\nimport { MaskFormatPipe } from \"../pipes/mask.pipe\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nimport * as i2 from \"../pipes/mask.pipe\";\nimport * as i3 from \"@angular/platform-browser\";\nimport * as i4 from \"../../common/services/api.service\";\n\nvar _c0 = function _c0(a0, a1, a2) {\n  return {\n    \"badge-success\": a0,\n    \"badge-danger\": a1,\n    \"badge\": a2\n  };\n};\n\nfunction BindCustomComponent_span_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 3);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(2, _c0, ctx_r0.badge && ctx_r0.model, ctx_r0.badge && !ctx_r0.model, ctx_r0.badge));\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.value);\n  }\n}\n\nfunction BindCustomComponent_label_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r1.value);\n  }\n}\n\nfunction BindCustomComponent_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r2.value);\n  }\n}\n\nfunction BindCustomComponent_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r3.value);\n  }\n}\n\nfunction BindCustomComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"div\", 4);\n  }\n\n  if (rf & 2) {\n    var ctx_r4 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"innerHTML\", ctx_r4.value, i0.ɵɵsanitizeHtml);\n  }\n}\n\nexport var BindCustomComponent = /*#__PURE__*/(function () {\n  var BindCustomComponent = /*#__PURE__*/function () {\n    function BindCustomComponent(decimalPipe, percentPipe, currencyPipe, maskPipe, sanitizer, api) {\n      _classCallCheck(this, BindCustomComponent);\n\n      this.decimalPipe = decimalPipe;\n      this.percentPipe = percentPipe;\n      this.currencyPipe = currencyPipe;\n      this.maskPipe = maskPipe;\n      this.sanitizer = sanitizer;\n      this.api = api;\n      this.datePipe = new DatePipe(\"pt-BR\");\n    }\n\n    _createClass(BindCustomComponent, [{\n      key: \"ngOnInit\",\n      value: function ngOnInit() {}\n    }, {\n      key: \"ngOnChanges\",\n      value: function ngOnChanges(changes) {\n        if (this.format.toLocaleLowerCase() === 'date') {\n          this.value = this.datePipe.transform(this.convertDate(this.model), 'dd/MM/yyyy');\n        } else if (this.format.toLocaleLowerCase() === 'time') {\n          this.value = this.datePipe.transform(this.convertDate(this.model), 'HH:mm');\n        } else if (this.format.toLocaleLowerCase() === 'datetime' || this.format.toLocaleLowerCase() === 'datetime?') {\n          this.value = this.datePipe.transform(this.convertDate(this.model), 'dd/MM/yyyy HH:mm');\n        } else if (this.format.toLocaleLowerCase() === 'yearmonth' || this.format.toLocaleLowerCase() === 'yearmonth?') {\n          this.value = this.datePipe.transform(this.convertDate(this.model), 'MM/yyyy');\n        } else if ((this.format.toLocaleLowerCase() === 'integer' || this.format.toLocaleLowerCase() === 'int' || this.format.toLocaleLowerCase() === 'int?') && !isNaN(this.convertNumber(this.model))) {\n          this.value = this.decimalPipe.transform(this.convertNumber(this.model), '1.0-0');\n        } else if ((this.format.toLocaleLowerCase() === 'decimal' || this.format.toLocaleLowerCase() === 'decimal?') && !isNaN(this.convertNumber(this.model))) {\n          this.value = this.decimalPipe.transform(this.convertNumber(this.model), '1.2-2');\n        } else if (this.format.toLocaleLowerCase() === 'percent' && !isNaN(this.convertNumber(this.model))) {\n          this.value = this.percentPipe.transform(this.convertNumber(this.model), '1.2-2');\n        } else if (this.format.toLocaleLowerCase() === 'currency' && !isNaN(this.convertNumber(this.model))) {\n          this.value = this.currencyPipe.transform(this.convertNumber(this.model), 'BRL', true, '1.2-2');\n        } else if (this.format.toLocaleLowerCase() === 'instance') {\n          this._getInstance();\n        } else if (this.format.toLocaleLowerCase() === 'dataitem') {\n          this.value = this._getInDataItem(this.model, this.aux);\n        } else if (this.format.toLocaleLowerCase() === 'changevalue') {\n          this.value = this._getChangeForThis(this.model, this.aux);\n        } else if (this.format.toLocaleLowerCase() === 'bool' || this.format.toLocaleLowerCase() === 'bool?') {\n          this.value = this.model == true ? \"Sim\" : \"Não\";\n          this.badge = true;\n        } else if (this.format.toLocaleLowerCase() === 'html') {\n          this.tag = \"inner\";\n          this.value = this.sanitizer.bypassSecurityTrustHtml(this.model);\n        } else if (this.format.toLocaleLowerCase() === 'tag') {\n          if (this.model) {\n            var itens = this.model.split(',');\n            var content = \"<ul>\";\n\n            for (var i in itens) {\n              content += \"<li><div class='badge badge-default'>\" + itens[i] + \"</div></li>\";\n            }\n\n            content += \"</ul>\";\n            this.tag = \"inner\";\n            this.value = this.sanitizer.bypassSecurityTrustHtml(content);\n          }\n        } else if (this.format.toLocaleLowerCase() === 'mask' && this.model) {\n          this.value = this.maskPipe.transform(this.model, this.mask);\n        } else if (this.format.toLocaleLowerCase() === 'color-legend') {\n          this.tag = \"inner\";\n          var hex = String(this.model || '').replace('#', '');\n          var content = '<div class=\"badge status-circle color-change new-color-' + hex + '\"><span class=\"invisible\">a<span></div>';\n\n          this._treatStatus(this.model);\n\n          this.value = content;\n        } else {\n          this.value = this.model;\n        }\n      }\n    }, {\n      key: \"convertNumber\",\n      value: function convertNumber(value) {\n        if (value) {\n          var number = value.toString().replace(\".\", \"\").replace(\",\", \".\");\n          return number;\n        }\n      }\n    }, {\n      key: \"convertDate\",\n      value: function convertDate(value) {\n        //if (value) {\n        //    var datePart = value.toString().split(\"/\");\n        //    var convertedDate = datePart[1] + \"/\" + datePart[0] + \"/\" + datePart[2];\n        //    return new Date(convertedDate);\n        //}\n        return value;\n      }\n    }, {\n      key: \"_getInDataItem\",\n      value: function _getInDataItem(model, dataitem) {\n        if (dataitem) {\n          var result = dataitem.filter(function (item) {\n            return model == item.id;\n          });\n          return result.length > 0 ? result[0].name : \"--\";\n        }\n\n        return \"--\";\n      }\n    }, {\n      key: \"_getChangeForThis\",\n      value: function _getChangeForThis(model, newValue) {\n        return newValue;\n      }\n    }, {\n      key: \"_getInstance\",\n      value: function _getInstance() {\n        var _this = this;\n\n        if (!this.instance || !this.model) {\n          return;\n        }\n\n        var filters = [];\n        filters[this.key] = this.model;\n        this.api.setResource(this.instance, this.endpoint).getDataitem(filters).subscribe(function (data) {\n          _this.tag = \"inner\";\n          _this.value = \"--\";\n          if (data.dataList.length > 0) _this.value = _this.sanitizer.sanitize(SecurityContext.URL, \"<a href=\\\"\" + _this.instance.toLowerCase() + \"\\/details/\" + data.dataList[0].id + \"\\\">\" + data.dataList[0].name + \"</a>\");\n        });\n      }\n    }, {\n      key: \"_treatStatus\",\n      value: function _treatStatus(data) {\n        if (this.model != null) {\n          var valor = $(\".color-change\");\n          valor.each(function () {\n            var pos = String($(this).attr('class')).indexOf('new-color-');\n            $(this).css('color', '#' + String($(this).attr('class')).substr(pos + 10, 6));\n            $(this).css('background-color', '#' + String($(this).attr('class')).substr(pos + 10, 6));\n          });\n          var color = valor.innerHTML;\n        }\n      }\n    }]);\n\n    return BindCustomComponent;\n  }();\n\n  BindCustomComponent.ɵfac = function BindCustomComponent_Factory(t) {\n    return new (t || BindCustomComponent)(i0.ɵɵdirectiveInject(i1.DecimalPipe), i0.ɵɵdirectiveInject(i1.PercentPipe), i0.ɵɵdirectiveInject(i1.CurrencyPipe), i0.ɵɵdirectiveInject(i2.MaskFormatPipe), i0.ɵɵdirectiveInject(i3.DomSanitizer), i0.ɵɵdirectiveInject(i4.ApiService));\n  };\n\n  BindCustomComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: BindCustomComponent,\n    selectors: [[\"bind-custom\"]],\n    inputs: {\n      model: \"model\",\n      format: \"format\",\n      tag: \"tag\",\n      instance: \"instance\",\n      endpoint: \"endpoint\",\n      key: \"key\",\n      aux: \"aux\",\n      mask: \"mask\"\n    },\n    features: [i0.ɵɵProvidersFeature([DatePipe, DecimalPipe, PercentPipe, CurrencyPipe, MaskFormatPipe, ApiService]), i0.ɵɵNgOnChangesFeature],\n    decls: 5,\n    vars: 5,\n    consts: [[3, \"ngClass\", 4, \"ngIf\"], [4, \"ngIf\"], [\"style\", \"display: inherit;\", 3, \"innerHTML\", 4, \"ngIf\"], [3, \"ngClass\"], [2, \"display\", \"inherit\", 3, \"innerHTML\"]],\n    template: function BindCustomComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, BindCustomComponent_span_0_Template, 2, 6, \"span\", 0);\n        i0.ɵɵtemplate(1, BindCustomComponent_label_1_Template, 2, 1, \"label\", 1);\n        i0.ɵɵtemplate(2, BindCustomComponent_p_2_Template, 2, 1, \"p\", 1);\n        i0.ɵɵtemplate(3, BindCustomComponent_div_3_Template, 2, 1, \"div\", 1);\n        i0.ɵɵtemplate(4, BindCustomComponent_div_4_Template, 1, 1, \"div\", 2);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", ctx.tag === \"span\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.tag === \"label\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.tag === \"p\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.tag === \"div\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.tag === \"inner\");\n      }\n    },\n    encapsulation: 2\n  });\n  return BindCustomComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}